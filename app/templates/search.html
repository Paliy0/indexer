{% extends "base.html" %}

{% block title %}Search {{ site.domain }}{% endblock %}

{% block content %}
<h1>Search {{ site.domain }}</h1>

<div class="info">
    <strong>Site:</strong> <a href="{{ site.url }}" target="_blank">{{ site.url }}</a>
    &bull; <span class="status-badge status-{{ site.status }}">{{ site.status }}</span>
    &bull; {{ site.page_count }} pages indexed
</div>

<form hx-get="/api/search/partial"
      hx-trigger="keyup changed delay:300ms from:#search-input, submit"
      hx-target="#search-results"
      hx-indicator="#loading-indicator">
    <input 
        type="search" 
        name="q" 
        id="search-input"
        value="{{ query }}" 
        placeholder="Search {{ site.domain }}..." 
        class="search-box"
        autofocus
        autocomplete="off"
    >
    <input type="hidden" name="site_id" value="{{ site.id }}">
    <button type="submit">Search</button>
    <span id="loading-indicator" class="htmx-indicator">
        <span class="loading-spinner"></span>
    </span>
</form>

<div id="search-results">
    {% include "partials/search_results.html" %}
</div>

<div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #e0e0e0;">
    <p><a href="/">‚Üê Back to all sites</a></p>
</div>
{% endblock %}
